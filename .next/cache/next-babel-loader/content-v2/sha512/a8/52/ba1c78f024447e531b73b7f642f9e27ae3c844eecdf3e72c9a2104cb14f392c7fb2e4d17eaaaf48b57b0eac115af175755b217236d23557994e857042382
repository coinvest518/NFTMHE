{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\n/* eslint-disable jsx-a11y/no-static-element-interactions */\nimport React, { useEffect, useState } from 'react';\nimport style from './TernoaWallet.module.scss';\nimport Close from 'components/assets/close';\nimport QRCode from 'components/base/QRCode';\nimport randomstring from 'randomstring';\nimport Cookies from 'js-cookie';\nimport { onModelClose } from 'utils/model-helpers';\nimport { connect as connectIo } from 'utils/socket/socket.helper';\n\nvar TernoaWallet = function TernoaWallet(_ref) {\n  var setModalExpand = _ref.setModalExpand;\n\n  var _useState = useState(randomstring.generate()),\n      session = _useState[0];\n\n  var _useState2 = useState(''),\n      error = _useState2[0],\n      setError = _useState2[1];\n\n  var _useState3 = useState(false),\n      showQR = _useState3[0],\n      setShowQR = _useState3[1];\n\n  useEffect(function () {\n    console.log('socket connect on session', session);\n    var socket = connectIo(\"/socket/login\", {\n      session: session\n    });\n    socket.on('CONNECTION_SUCCESS', function () {\n      setShowQR(true);\n    });\n    socket.on('connect_error', function (e) {\n      console.error('connection error socket', e);\n      setModalExpand(false);\n    });\n    socket.on('disconnect', function (data) {\n      console.log('deco', data);\n      setModalExpand(false);\n    });\n    socket.on('CONNECTION_FAILURE', function (data) {\n      return setError(data.msg);\n    });\n    socket.on('RECEIVE_WALLET_ID', function (data) {\n      console.log('SEND_WALLET_ID', data);\n      Cookies.set('token', data.walletId, {\n        sameSite: 'strict',\n        expires: 1\n      });\n      socket.emit('RECEIVED_WALLET_ID', data);\n      socket.close();\n      window.location.reload();\n    });\n    return function cleanup() {\n      socket.close();\n    };\n  }, []);\n  return /*#__PURE__*/_jsx(\"div\", {\n    id: \"ternoaWallet\",\n    className: style.Background,\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: style.Container,\n      children: [/*#__PURE__*/_jsx(Close, {\n        onClick: function onClick() {\n          onModelClose();\n          setModalExpand(false);\n        },\n        className: style.Close\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: style.Title,\n        children: \"Wallet connect\"\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: style.Text,\n        children: \"To authenticate, scan this QR Code from your Ternoa Wallet mobile application.\"\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: style.QR,\n        children: showQR ? /*#__PURE__*/_jsx(QRCode, {\n          data: {\n            session: session\n          },\n          action: 'LOGIN'\n        }) : /*#__PURE__*/_jsxs(\"div\", {\n          className: style.Loading,\n          children: [/*#__PURE__*/_jsx(\"span\", {\n            className: style.Dot\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: style.Dot\n          }), /*#__PURE__*/_jsx(\"span\", {\n            className: style.Dot\n          })]\n        })\n      }), error && /*#__PURE__*/_jsx(\"div\", {\n        className: style.Error,\n        children: error\n      })]\n    })\n  });\n};\n\nexport default TernoaWallet;","map":null,"metadata":{},"sourceType":"module"}